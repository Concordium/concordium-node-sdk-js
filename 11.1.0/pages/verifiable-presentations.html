<!DOCTYPE html><html class="default" lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>Verifiable presentations | Concordium JS-SDK</title><meta name="description" content="Documentation for Concordium JS-SDK"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script async src="../assets/search.js" id="search-script"></script><link rel="stylesheet" href="../assets/code-blocks.css"/><link rel="stylesheet" href="../assets/pages.css"/></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os"</script><header class="tsd-page-toolbar">
<div class="tsd-toolbar-contents container">
<div class="table-cell" id="tsd-search" data-base="..">
<div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M15.7824 13.833L12.6666 10.7177C12.5259 10.5771 12.3353 10.499 12.1353 10.499H11.6259C12.4884 9.39596 13.001 8.00859 13.001 6.49937C13.001 2.90909 10.0914 0 6.50048 0C2.90959 0 0 2.90909 0 6.49937C0 10.0896 2.90959 12.9987 6.50048 12.9987C8.00996 12.9987 9.39756 12.4863 10.5008 11.6239V12.1332C10.5008 12.3332 10.5789 12.5238 10.7195 12.6644L13.8354 15.7797C14.1292 16.0734 14.6042 16.0734 14.8948 15.7797L15.7793 14.8954C16.0731 14.6017 16.0731 14.1267 15.7824 13.833ZM6.50048 10.499C4.29094 10.499 2.50018 8.71165 2.50018 6.49937C2.50018 4.29021 4.28781 2.49976 6.50048 2.49976C8.71001 2.49976 10.5008 4.28708 10.5008 6.49937C10.5008 8.70852 8.71314 10.499 6.50048 10.499Z" fill="var(--color-text)"></path></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div>
<div class="field">
<div id="tsd-toolbar-links"></div></div>
<ul class="results">
<li class="state loading">Preparing search index...</li>
<li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">Concordium JS-SDK</a></div>
<div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><rect x="1" y="3" width="14" height="2" fill="var(--color-text)"></rect><rect x="1" y="7" width="14" height="2" fill="var(--color-text)"></rect><rect x="1" y="11" width="14" height="2" fill="var(--color-text)"></rect></svg></a></div></div></header>
<div class="container container-main">
<div class="col-8 col-content">
<div class="tsd-page-title">
<ul class="tsd-breadcrumb">
<li><a href="../modules.html">Concordium JS-SDK</a></li>
<li><span>Concordium JS-SDK</span></li>
<li><a href="verifiable-presentations.html">Verifiable presentations</a></li></ul>
<h1> Verifiable presentations</h1></div>
<div class="tsd-panel tsd-typography">
<a href="#verifiable-presentations-v1" id="verifiable-presentations-v1" style="color: inherit; text-decoration: none;">
  <h1>Verifiable Presentations (V1)</h1>
</a>
<p>This document describes how to create v1 verifiable presentations and how to verify them.</p>
<p><strong>Table of Contents:</strong></p>
<!--toc:start-->
<ul>
<li><a href="#build-subject-claims">Build Subject Claims</a><ul>
<li><a href="#identityaccount-credential-claims">Identity/account credential claims</a></li>
</ul>
</li>
<li><a href="#json-representation">JSON representation</a></li>
<li><a href="#verification-request">Verification Request</a></li>
<li><a href="#verifiable-presentation">Verifiable Presentation</a></li>
<li><a href="#verifiable-audit-record">Verifiable Audit Record</a><!--toc:end--></li>
</ul>

<a href="#build-subject-claims" id="build-subject-claims" style="color: inherit; text-decoration: none;">
  <h2>Build Subject claims</h2>
</a>
<p>The SDK contains a helper to create as set of subject claims about identities, which can
then be proven.</p>
<p>To do so, use the <em>presentation request claims builder</em>, to build a set of claims:</p>
<details class="code-block" open><summary>
<p>From <a href="https://github.com/Concordium/concordium-node-sdk-js/blob/fc47aeb/examples/nodejs/common/verifiable-credential-claims.ts#L3">./../examples/nodejs/common/verifiable-credential-claims.ts#3~23</a></p></summary>
<pre><code class="language-ts"><span class="hl-4">let</span><span class="hl-0"> </span><span class="hl-2">builder</span><span class="hl-0"> = </span><span class="hl-2">VerificationRequestV1</span><span class="hl-0">.</span><span class="hl-5">claimsBuilder</span><span class="hl-0">();</span><br/><br/><span class="hl-11">// Add a set of identity credential claims. Alternatively, if the proof produced from the</span><br/><span class="hl-11">// claims should be tied to an account, use `builder.addAccountClaims`.</span><br/><span class="hl-11">// A third option `builder.addAccountOrIdentityClaims`exists where it&#39;s up to the</span><br/><span class="hl-11">// application holding the credentials to decide which proof is produced.</span><br/><span class="hl-2">builder</span><span class="hl-0"> = </span><span class="hl-2">builder</span><span class="hl-0">.</span><span class="hl-5">addIdentityClaims</span><span class="hl-0">(</span><br/><span class="hl-0">    [</span><span class="hl-6">0</span><span class="hl-0">, </span><span class="hl-6">1</span><span class="hl-0">].</span><span class="hl-5">map</span><span class="hl-0">((</span><span class="hl-2">idpIndex</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-5">IdentityProviderDID</span><span class="hl-0">(</span><span class="hl-3">&#39;Testnet&#39;</span><span class="hl-0">, </span><span class="hl-2">idpIndex</span><span class="hl-0">)),</span><br/><span class="hl-0">    (</span><span class="hl-2">b</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">        </span><span class="hl-2">b</span><span class="hl-0">.</span><span class="hl-5">addMinimumAge</span><span class="hl-0">(</span><span class="hl-6">18</span><span class="hl-0">);</span><br/><span class="hl-0">        </span><span class="hl-2">b</span><span class="hl-0">.</span><span class="hl-5">addEUResidency</span><span class="hl-0">();</span><br/><span class="hl-0">        </span><span class="hl-2">b</span><span class="hl-0">.</span><span class="hl-5">revealAttribute</span><span class="hl-0">(</span><span class="hl-3">&#39;firstName&#39;</span><span class="hl-0">);</span><br/><span class="hl-0">    }</span><br/><span class="hl-0">);</span><br/><br/><span class="hl-11">// Get the complete set of claims to request a proof of.</span><br/><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-9">claims</span><span class="hl-0"> = </span><span class="hl-2">builder</span><span class="hl-0">.</span><span class="hl-5">getClaims</span><span class="hl-0">();</span><br/><br/><span class="hl-2">console</span><span class="hl-0">.</span><span class="hl-5">log</span><span class="hl-0">(</span><span class="hl-3">&#39;successfully constructed subject claims&#39;</span><span class="hl-0">, </span><span class="hl-2">claims</span><span class="hl-0">);</span>
</code></pre>
</details>


<a href="#identityaccount-credential-claims" id="identityaccount-credential-claims" style="color: inherit; text-decoration: none;">
  <h3>Identity/account credential claims</h3>
</a>
<p>To build a set of claims against an identity credential, the builder has two different entrypoints, which
have an identical function signature, which consists of</p>
<ol>
<li>A list of identity providers that the identity must be created from</li>
<li>A callback function which should be used to add claims for the credential</li>
</ol>
<pre><code class="language-ts"><span class="hl-11">// used for proofs tied to an account created from the identity credential.</span><br/><span class="hl-2">builder</span><span class="hl-0">.</span><span class="hl-5">addAccountClaims</span><span class="hl-0">([</span><span class="hl-6">0</span><span class="hl-0">,</span><span class="hl-6">2</span><span class="hl-0">].</span><span class="hl-5">map</span><span class="hl-0">(</span><span class="hl-2">idp</span><span class="hl-0"> </span><span class="hl-4">=&gt;</span><span class="hl-0"> </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-5">IdentityProviderDID</span><span class="hl-0">(</span><span class="hl-3">&#39;Testnet&#39;</span><span class="hl-0">, </span><span class="hl-2">idp</span><span class="hl-0">)), (</span><span class="hl-2">build</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> ...)</span><br/><span class="hl-11">// used for proofs which are not tied to a specific account</span><br/><span class="hl-2">builder</span><span class="hl-0">.</span><span class="hl-5">addIdentityClaims</span><span class="hl-0">([</span><span class="hl-6">0</span><span class="hl-0">,</span><span class="hl-6">2</span><span class="hl-0">].</span><span class="hl-5">map</span><span class="hl-0">(</span><span class="hl-2">idp</span><span class="hl-0"> </span><span class="hl-4">=&gt;</span><span class="hl-0"> </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-5">IdentityProviderDID</span><span class="hl-0">(</span><span class="hl-3">&#39;Testnet&#39;</span><span class="hl-0">, </span><span class="hl-2">idp</span><span class="hl-0">)), (</span><span class="hl-2">build</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> ...)</span><br/><span class="hl-11">// alternatively let the application producing the proof decide</span><br/><span class="hl-2">builder</span><span class="hl-0">.</span><span class="hl-5">addAccountOrIdentityClaims</span><span class="hl-0">([</span><span class="hl-6">0</span><span class="hl-0">,</span><span class="hl-6">2</span><span class="hl-0">].</span><span class="hl-5">map</span><span class="hl-0">(</span><span class="hl-2">idp</span><span class="hl-0"> </span><span class="hl-4">=&gt;</span><span class="hl-0"> </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-5">IdentityProviderDID</span><span class="hl-0">(</span><span class="hl-3">&#39;Testnet&#39;</span><span class="hl-0">, </span><span class="hl-2">idp</span><span class="hl-0">)), (</span><span class="hl-2">build</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> ...)</span>
</code></pre>
<p>Below are a set of functions accessible for the <code>build</code> object passed in the callback</p>

<a href="#minimum-age" id="minimum-age" style="color: inherit; text-decoration: none;">
  <h4>Minimum Age</h4>
</a>
<p>There is a helper function for specifying the prover must have some minimum
age.</p>
<p>Example: add the statement that the prover must be at least 18 years old:</p>
<pre><code class="language-ts"><span class="hl-0">    </span><span class="hl-2">build</span><span class="hl-0">.</span><span class="hl-5">addMinimumAge</span><span class="hl-0">(</span><span class="hl-6">18</span><span class="hl-0">);</span>
</code></pre>

<a href="#maximum-age" id="maximum-age" style="color: inherit; text-decoration: none;">
  <h4>Maximum Age</h4>
</a>
<p>There is a helper function for specifying the prover must have some maximum
age.</p>
<p>Example: add the statement that the prover must be at most 27 years old:</p>
<pre><code class="language-ts"><span class="hl-0">    </span><span class="hl-2">build</span><span class="hl-0">.</span><span class="hl-5">addMaximumAge</span><span class="hl-0">(</span><span class="hl-6">27</span><span class="hl-0">);</span>
</code></pre>

<a href="#eu-membership" id="eu-membership" style="color: inherit; text-decoration: none;">
  <h4>EU membership</h4>
</a>
<p>There are helpers for specifying the country of residency or nationality to
be one of the EU member states.</p>
<pre><code class="language-ts"><span class="hl-0">    </span><span class="hl-2">build</span><span class="hl-0">.</span><span class="hl-5">addEUNationality</span><span class="hl-0">();</span><br/><span class="hl-0">    </span><span class="hl-2">build</span><span class="hl-0">.</span><span class="hl-5">addEUResidency</span><span class="hl-0">();</span>
</code></pre>

<a href="#reveal-statement" id="reveal-statement" style="color: inherit; text-decoration: none;">
  <h4>Reveal statement</h4>
</a>
<p>State that a given attribute should be revealed as part of the proof.</p>
<pre><code class="language-ts"><span class="hl-0">    </span><span class="hl-2">build</span><span class="hl-0">.</span><span class="hl-5">revealAttribute</span><span class="hl-0">(</span><span class="hl-2">AttributesKeys</span><span class="hl-0">.</span><span class="hl-2">nationality</span><span class="hl-0">);</span>
</code></pre>

<a href="#range-statement" id="range-statement" style="color: inherit; text-decoration: none;">
  <h4>Range statement</h4>
</a>
<p>State that a given attribute should be between 2 given values.</p>
<p>Example: add the statement that the prover must be born between January 1,
1941 and Februar 2, 2005.</p>
<pre><code class="language-ts"><span class="hl-0">    </span><span class="hl-2">build</span><span class="hl-0">.</span><span class="hl-5">addRange</span><span class="hl-0">(</span><span class="hl-2">AttributesKeys</span><span class="hl-0">.</span><span class="hl-2">dob</span><span class="hl-0">, </span><span class="hl-6">19410101</span><span class="hl-0">, </span><span class="hl-6">20050202</span><span class="hl-0">);</span>
</code></pre>
<p>Note that this type of statement is only allowed for the following attributes:</p>
<ul>
<li>dob (date of birth)</li>
<li>idDocIssuedAt</li>
<li>idDocExpiresAt</li>
</ul>

<a href="#membership-statement" id="membership-statement" style="color: inherit; text-decoration: none;">
  <h4>Membership statement</h4>
</a>
<p>Example: add the statement that the prover&#39;s country of residency is France or Spain,
specified in ISO3166-1 alpha-2 format:</p>
<pre><code class="language-ts"><span class="hl-0">    </span><span class="hl-2">build</span><span class="hl-0">.</span><span class="hl-5">addMembership</span><span class="hl-0">(</span><span class="hl-2">AttributesKeys</span><span class="hl-0">.</span><span class="hl-2">CountryOfResidency</span><span class="hl-0">, [</span><span class="hl-3">&#39;FR&#39;</span><span class="hl-0">, </span><span class="hl-3">&#39;ES&#39;</span><span class="hl-0">]);</span>
</code></pre>
<p>Note that this type of statement is only allowed for the following attributes:</p>
<ul>
<li>Nationality</li>
<li>CountryOfResidency</li>
<li>IdDocIssuer</li>
<li>IdDocType</li>
</ul>

<a href="#non-membership-statement" id="non-membership-statement" style="color: inherit; text-decoration: none;">
  <h4>Non membership statement</h4>
</a>
<p>Example: add the statement that the prover&#39;s country of residency not Germany
nor Portugal:</p>
<pre><code class="language-ts"><span class="hl-0">    </span><span class="hl-2">build</span><span class="hl-0">.</span><span class="hl-5">addNonMembership</span><span class="hl-0">(</span><span class="hl-2">AttributesKeys</span><span class="hl-0">.</span><span class="hl-2">CountryOfResidency</span><span class="hl-0">, [</span><span class="hl-3">&#39;DE&#39;</span><span class="hl-0">, </span><span class="hl-3">&#39;PT&#39;</span><span class="hl-0">]);</span>
</code></pre>
<p>Note that this type of statement is only allowed for the following attributes:</p>
<ul>
<li>Nationality</li>
<li>CountryOfResidency</li>
<li>IdDocIssuer</li>
<li>IdDocType</li>
</ul>

<a href="#json-representation" id="json-representation" style="color: inherit; text-decoration: none;">
  <h2>JSON representation</h2>
</a>
<p>The <code>VerificationRequestV1</code>, <code>VerifiablePresentationV1</code>, and <code>VerifiableAuditRecordV1</code> can be represented as
JSON by calling the associated <code>.toJSON</code> method (will also be called implicitly with <code>JSON.stringify</code>). Correspondingly,
parsing the JSON values can be done with the <code>.fromJSON</code> function exposed for each type.</p>
<blockquote>
<p>bigints are used internally in the types described above and need to be handled with something like <code>json-bigint</code></p>
</blockquote>
<p>Example: service serializes presentation request in response to frontend; frontend deserializes and parses the JSON.</p>
<pre><code class="language-ts"><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-9">json</span><span class="hl-0"> = </span><span class="hl-9">JSON</span><span class="hl-0">.</span><span class="hl-5">stringify</span><span class="hl-0">(</span><span class="hl-2">presentationRequest</span><span class="hl-0">); </span><span class="hl-11">// service sends back presentation request to frontend</span><br/><span class="hl-0">...</span><br/><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-9">presentationRequest</span><span class="hl-0"> = </span><span class="hl-2">VerificationRequestV1</span><span class="hl-0">.</span><span class="hl-5">fromJSON</span><span class="hl-0">(</span><span class="hl-9">JSON</span><span class="hl-0">.</span><span class="hl-5">parse</span><span class="hl-0">(</span><span class="hl-2">json</span><span class="hl-0">)); </span><span class="hl-11">// frontend parses the JSON.</span>
</code></pre>

<a href="#verification-request" id="verification-request" style="color: inherit; text-decoration: none;">
  <h2>Verification Request</h2>
</a>
<p>To get a <em>verifiable presentation</em> of one or more <em>verifiable credentials</em> owned by a user, the entity requesting
the information must first build a <em>verification request</em>. In the V1 protocol, this is done in the following
sequence:</p>
<ol>
<li>Make the <em>request context</em>, consisting of
  a. a unique 32-byte &quot;nonce&quot;
  b. a &quot;connection ID&quot; which identifies the connection between prover and requester
  c. a &quot;context string&quot; which describes the context of the proof request, e.g. which store is being accessed
  d. a set of requested context values, identified by their labels. For now the defaults here are: the block hash of the
  anchor transaction and the resource ID (i.e. an identifier of the requester, e.g. a url of the website). The
  requested context is filled out by the application creating the proof.</li>
<li><a href="#build-subject-claims">Build the claims</a> to be proven by the user</li>
</ol>
<p>Once this is done, the request must be <em>anchored</em> on chain with a transaction. This can be achieved by calling</p>
<pre><code class="language-ts"><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-9">nonce</span><span class="hl-0"> = </span><span class="hl-2">Uint8Array</span><span class="hl-0">.</span><span class="hl-5">from</span><span class="hl-0">(...) </span><span class="hl-11">// randomly generated 32-byte value</span><br/><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-9">connectionID</span><span class="hl-0"> = ... </span><span class="hl-11">// e.g. a wallet-connect ID</span><br/><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-9">contextString</span><span class="hl-0"> = </span><span class="hl-3">&#39;My compliant web3 wine shop&#39;</span><br/><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-9">rescourceID</span><span class="hl-0"> = </span><span class="hl-3">&#39;My website URL&#39;</span><span class="hl-0"> </span><span class="hl-11">// e.g. website URL or TLS fingerprint</span><br/><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-9">context</span><span class="hl-0"> = </span><span class="hl-2">VerificationRequestV1</span><span class="hl-0">.</span><span class="hl-5">createSimpleContext</span><span class="hl-0">(</span><span class="hl-2">nonce</span><span class="hl-0">, </span><span class="hl-2">connectionID</span><span class="hl-0">, </span><span class="hl-2">rescourceID</span><span class="hl-0">, </span><span class="hl-2">contextString</span><span class="hl-0">)</span><br/><br/><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-9">statement</span><span class="hl-0"> = </span><span class="hl-4">new</span><span class="hl-0"> </span><span class="hl-2">VerificationRequestV1</span><span class="hl-0">.</span><span class="hl-5">claimsBuilder</span><span class="hl-0">()...</span><br/><br/><span class="hl-11">// a GRPC client connected a node on the network the anchor should be registered on</span><br/><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-9">grpcClient</span><span class="hl-0">: </span><span class="hl-10">ConcordiumGRPCClient</span><span class="hl-0"> = ...;</span><br/><span class="hl-11">// the sender of the anchor transaction</span><br/><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-9">sender</span><span class="hl-0">: </span><span class="hl-10">AccountAddress</span><span class="hl-0">.</span><span class="hl-10">Type</span><span class="hl-0"> = ...;</span><br/><span class="hl-11">// the keys for the account to sign the anchor transaction</span><br/><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-9">signer</span><span class="hl-0">: </span><span class="hl-10">Signer</span><span class="hl-0"> = ...;</span><br/><br/><span class="hl-11">// create the verification request with an on-chain anchor, which can be checked by the owner of the credentials.</span><br/><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-9">verificationRequest</span><span class="hl-0"> = </span><span class="hl-1">await</span><span class="hl-0"> </span><span class="hl-2">VerificationRequestV1</span><span class="hl-0">.</span><span class="hl-5">createAndAnchor</span><span class="hl-0">(</span><br/><span class="hl-0">    </span><span class="hl-2">grpcClient</span><span class="hl-0">,</span><br/><span class="hl-0">    { </span><span class="hl-2">sender</span><span class="hl-0">, </span><span class="hl-2">signer</span><span class="hl-0"> }</span><br/><span class="hl-0">    </span><span class="hl-2">context</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-2">statement</span><br/><span class="hl-0">);</span>
</code></pre>

<a href="#verifiable-presentation" id="verifiable-presentation" style="color: inherit; text-decoration: none;">
  <h2>Verifiable Presentation</h2>
</a>
<p>Computing a <em>verifiable presentation</em> from a <em>verifiable presentation request</em> is a process of the following sequence
for each credential statement in the request:</p>
<ol>
<li>Identify valid credentials for the statement by looking at the ID qualifier of the
<code>VerificationRequestV1.SubjectClaims</code>.</li>
<li>Validate the attributes of the credential in the context of the set of claims.</li>
<li>Construct a <code>VerifiablePresentationV1.SubjectClaims</code> corresponding to the credential. This is is <em>not</em> the same as the
<code>VerificationRequestV1.Statement</code> we built for the <code>VerificationRequestV1</code> previously; here we&#39;re working with
a specific credential, e.g. from the users wallet.
 a. for <code>VerificationRequestV1.IdentityStatement</code>s, the <code>source</code> also needs to be taken into account. This
specifies the type of credential requested by the dapp. This can either be set to
<code>[&quot;Identity&quot;] | [&quot;Account&quot;] | [&quot;Identity&quot;, &quot;Account&quot;]</code>, where the latter means that the application constructing
the proof can decide which proof to construct for the statement.</li>
</ol>
<p>When this is done for all credential statements in the request, we construct the <em>proof context</em> corresponding to the
<em>request context</em> of the request, specifying values for each requested context value in
<code>VerificationRequestV1.Context.requested</code>.</p>
<pre><code class="language-ts"><span class="hl-11">// specify the resource ID (e.g. website URL or fingerprint of TLS certificate that the wallet is connected to)</span><br/><span class="hl-11">// from the connection to the requester of the proof. The block hash is _not_ specified here, as it is looked up</span><br/><span class="hl-11">// later in `VerifiablePresentationV1.createFromAnchor` from the anchor transaction reference in the presentation</span><br/><span class="hl-11">// request.</span><br/><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-9">contextValues</span><span class="hl-0">: </span><span class="hl-10">GivenContext</span><span class="hl-0">[] = [{</span><span class="hl-2">label:</span><span class="hl-0"> </span><span class="hl-3">&#39;ResourceID&#39;</span><span class="hl-0">, </span><span class="hl-2">context:</span><span class="hl-0"> ...}];</span><br/><br/><span class="hl-11">// The application goes through each set of claims in the verification request, and constructs a corresponding set of</span><br/><span class="hl-11">// claims used as input to the presentation. The difference between the two statement types boil down to the presence</span><br/><span class="hl-11">// of an ID qualifier vs. an ID (selected by the application based on the id qualifier).</span><br/><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-9">statements</span><span class="hl-0">: </span><span class="hl-10">VerifiablePresentationV1</span><span class="hl-0">.</span><span class="hl-10">SubjectClaims</span><span class="hl-0">[] = </span><span class="hl-2">verificationRequest</span><span class="hl-0">.</span><span class="hl-2">subjectClaims</span><span class="hl-0">.</span><span class="hl-5">map</span><span class="hl-0">((</span><span class="hl-2">entry</span><span class="hl-0">) </span><span class="hl-4">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-11">// prioritize creating identity based proofs, as these are more privacy-preserving</span><br/><span class="hl-0">    </span><span class="hl-1">if</span><span class="hl-0"> (</span><span class="hl-2">entry</span><span class="hl-0">.</span><span class="hl-2">source</span><span class="hl-0">.</span><span class="hl-5">includes</span><span class="hl-0">(</span><span class="hl-3">&#39;identity&#39;</span><span class="hl-0">))</span><br/><span class="hl-0">        </span><span class="hl-1">return</span><span class="hl-0"> </span><span class="hl-2">VerifiablePresentationV1</span><span class="hl-0">.</span><span class="hl-5">createIdentityClaims</span><span class="hl-0">(..., </span><span class="hl-2">entry</span><span class="hl-0">.</span><span class="hl-2">statement</span><span class="hl-0">);</span><br/><span class="hl-0">    </span><span class="hl-1">return</span><span class="hl-0"> </span><span class="hl-2">VerifiablePresentation</span><span class="hl-0">.</span><span class="hl-5">createAccountClaims</span><span class="hl-0">(..., </span><span class="hl-2">entry</span><span class="hl-0">.</span><span class="hl-2">statement</span><span class="hl-0">);</span><br/><span class="hl-0">});</span><br/><br/><span class="hl-11">// the inputs for the credential owned by the user, i.e. credential attribute values. For each</span><br/><span class="hl-11">// `VerifiablePresentationV1.SubjectClaims`, there should be a corresponding input</span><br/><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-9">inputs</span><span class="hl-0">: </span><span class="hl-10">CommitmentInput</span><span class="hl-0">[] = [</span><br/><span class="hl-0">    </span><span class="hl-5">createIdentityCommitmentInputWithHdWallet</span><span class="hl-0">(...),</span><br/><span class="hl-0">    </span><span class="hl-5">createAccountCommitmentInputWithHdWallet</span><span class="hl-0">(...),</span><br/><span class="hl-0">];</span><br/><br/><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-9">presentation</span><span class="hl-0"> = </span><span class="hl-1">await</span><span class="hl-0"> </span><span class="hl-2">VerifiablePresentationV1</span><span class="hl-0">.</span><span class="hl-5">createFromAnchor</span><span class="hl-0">(</span><br/><span class="hl-0">    </span><span class="hl-2">grpcClient</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-2">verificationRequest</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-2">statements</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-2">inputs</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-2">contextValues</span><br/><span class="hl-0">);</span>
</code></pre>

<a href="#verifiable-audit-record" id="verifiable-audit-record" style="color: inherit; text-decoration: none;">
  <h2>Verifiable Audit Record</h2>
</a>
<p>Services can opt in to create a <em>verification audit record</em> from the <em>verification request</em> and corresponding
<em>verifiable presentation</em>. This exists as a record and a corresponding anchor. The record should be stored by the dapp backend (e.g. in a database),
and the anchor should be registered on chain. The transacton hash of the anchor registration should be stored along the record.</p>
<pre><code class="language-ts"><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-9">uuid</span><span class="hl-0">: </span><span class="hl-10">string</span><span class="hl-0"> = ...;</span><br/><span class="hl-11">// Verify the presentation in the context of the verification request and create the audit record and register the audit</span><br/><span class="hl-11">// anchor.</span><br/><span class="hl-4">const</span><span class="hl-0"> </span><span class="hl-9">record</span><span class="hl-0"> = </span><span class="hl-2">VerificationAuditRecordV1</span><span class="hl-0">.</span><span class="hl-5">createAndAnchor</span><span class="hl-0">(</span><br/><span class="hl-0">    </span><span class="hl-2">uuid</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-2">verificationRequest</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-2">presentation</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-2">grpcClient</span><span class="hl-0">,</span><br/><span class="hl-0">    { </span><span class="hl-2">metadata:</span><span class="hl-0"> { </span><span class="hl-2">sender</span><span class="hl-0">, </span><span class="hl-2">signer</span><span class="hl-0"> } },</span><br/><span class="hl-0">    { </span><span class="hl-2">network</span><span class="hl-0"> }</span><br/><span class="hl-0">);</span>
</code></pre>
</div></div>
<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
<div class="tsd-navigation settings">
<details class="tsd-index-accordion"><summary class="tsd-accordion-summary">
<h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M4.93896 8.531L12 15.591L19.061 8.531L16.939 6.409L12 11.349L7.06098 6.409L4.93896 8.531Z" fill="var(--color-text)"></path></svg> Settings</h3></summary>
<div class="tsd-accordion-details">
<div class="tsd-filter-visibility">
<h4 class="uppercase">Member Visibility</h4><form>
<ul id="tsd-filter-options">
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-private" name="private"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Private</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></form></div>
<div class="tsd-theme-toggle">
<h4 class="uppercase">Theme</h4><select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div>
<nav class="tsd-navigation primary">
<details class="tsd-index-accordion" open><summary class="tsd-accordion-summary">
<h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M4.93896 8.531L12 15.591L19.061 8.531L16.939 6.409L12 11.349L7.06098 6.409L4.93896 8.531Z" fill="var(--color-text)"></path></svg> Modules</h3></summary>
<div class="tsd-accordion-details">
<ul>
<li class="current"><a href="../modules.html">Concordium JS-<wbr/>SDK</a>
<ul>
<li class="current pages-entry pages-entry-menu pages-entry-depth-1"><a>Concordium JS-<wbr/>SDK</a>
<ul>
<li class="pages-entry pages-entry-page pages-entry-depth-2"><a href="cis2-contracts.html">CIS2-<wbr/>Contracts</a></li>
<li class="pages-entry pages-entry-page pages-entry-depth-2"><a href="identity-proofs.html">Identity <wbr/>Proofs</a></li>
<li class="current selected pages-entry pages-entry-page pages-entry-depth-2"><a href="verifiable-presentations.html">Verifiable presentations</a></li>
<li class="pages-entry pages-entry-page pages-entry-depth-2"><a href="runnable-examples.html">Runnable <wbr/>Examples</a></li>
<li class="pages-entry pages-entry-page pages-entry-depth-2"><a href="transactions.html">Transactions</a></li>
<li class="pages-entry pages-entry-page pages-entry-depth-2"><a href="utility-functions.html">Utility <wbr/>Functions</a></li>
<li class="pages-entry pages-entry-menu pages-entry-depth-2"><a>Miscellaneous <wbr/>Pages</a>
<ul>
<li class="pages-entry pages-entry-page pages-entry-depth-3"><a href="misc-pages/account-creation.html">Account <wbr/>Creation</a></li>
<li class="pages-entry pages-entry-page pages-entry-depth-3"><a href="misc-pages/bundler-optimizations.html">Optimizing bundled applications</a></li>
<li class="pages-entry pages-entry-page pages-entry-depth-3"><a href="misc-pages/grpc-migration.html">GRPCv1 to GRPCv2 <wbr/>Migration <wbr/>Guide</a></li>
<li class="pages-entry pages-entry-page pages-entry-depth-3"><a href="misc-pages/grpc-v1.html">Old GRPC-<wbr/>Client</a></li>
<li class="pages-entry pages-entry-page pages-entry-depth-3"><a href="misc-pages/upgrade-guide.html">Upgrade <wbr/>Guide</a></li>
<li class="pages-entry pages-entry-page pages-entry-depth-3"><a href="misc-pages/react-native.html">React <wbr/>Native</a></li></ul></li></ul></li>
<li class="tsd-kind-module"><a href="../modules/cis0.html">cis0</a>
<ul>
<li class="tsd-kind-namespace tsd-parent-kind-module"><a href="../modules/cis0.CIS0.html">CIS0</a></li></ul></li>
<li class="tsd-kind-module"><a href="../modules/cis2.html">cis2</a>
<ul>
<li class="tsd-kind-namespace tsd-parent-kind-module"><a href="../modules/cis2.CIS2.html">CIS2</a></li></ul></li>
<li class="tsd-kind-module"><a href="../modules/cis3.html">cis3</a>
<ul>
<li class="tsd-kind-namespace tsd-parent-kind-module"><a href="../modules/cis3.CIS3.html">CIS3</a></li></ul></li>
<li class="tsd-kind-module"><a href="../modules/cis4.html">cis4</a>
<ul>
<li class="tsd-kind-namespace tsd-parent-kind-module"><a href="../modules/cis4.CIS4.html">CIS4</a></li></ul></li>
<li class="tsd-kind-module"><a href="../modules/grpc.html">grpc</a></li>
<li class="tsd-kind-module"><a href="../modules/id.html">id</a></li>
<li class="tsd-kind-module"><a href="../modules/nodejs.html">nodejs</a></li>
<li class="tsd-kind-module"><a href="../modules/plt.html">plt</a>
<ul>
<li class="tsd-kind-namespace tsd-parent-kind-module"><a href="../modules/plt.Token.html">Token</a></li></ul></li>
<li class="tsd-kind-module"><a href="../modules/plt_Cbor.html">plt/<wbr/>Cbor</a></li>
<li class="tsd-kind-module"><a href="../modules/plt_CborAccountAddress.html">plt/<wbr/>Cbor<wbr/>Account<wbr/>Address</a></li>
<li class="tsd-kind-module"><a href="../modules/plt_CborContractAddress.html">plt/<wbr/>Cbor<wbr/>Contract<wbr/>Address</a></li>
<li class="tsd-kind-module"><a href="../modules/plt_CborMemo.html">plt/<wbr/>Cbor<wbr/>Memo</a></li>
<li class="tsd-kind-module"><a href="../modules/plt_TokenAmount.html">plt/<wbr/>Token<wbr/>Amount</a></li>
<li class="tsd-kind-module"><a href="../modules/plt_TokenHolder.html">plt/<wbr/>Token<wbr/>Holder</a></li>
<li class="tsd-kind-module"><a href="../modules/plt_TokenId.html">plt/<wbr/>Token<wbr/>Id</a></li>
<li class="tsd-kind-module"><a href="../modules/plt_TokenMetadataUrl.html">plt/<wbr/>Token<wbr/>Metadata<wbr/>Url</a></li>
<li class="tsd-kind-module"><a href="../modules/plt_TokenModuleReference.html">plt/<wbr/>Token<wbr/>Module<wbr/>Reference</a></li>
<li class="tsd-kind-module"><a href="../modules/schema.html">schema</a></li>
<li class="tsd-kind-module"><a href="../modules/types.html">types</a>
<ul>
<li class="tsd-kind-namespace tsd-parent-kind-module"><a href="../modules/types.ContractName.html">Contract<wbr/>Name</a></li>
<li class="tsd-kind-namespace tsd-parent-kind-module"><a href="../modules/types.CredentialRegistrationId.html">Credential<wbr/>Registration<wbr/>Id</a></li>
<li class="tsd-kind-namespace tsd-parent-kind-module"><a href="../modules/types.EntrypointName.html">Entrypoint<wbr/>Name</a></li>
<li class="tsd-kind-namespace tsd-parent-kind-module"><a href="../modules/types.ModuleClient.html">Module<wbr/>Client</a></li></ul></li>
<li class="tsd-kind-module"><a href="../modules/types_AccountAddress.html">types/<wbr/>Account<wbr/>Address</a></li>
<li class="tsd-kind-module"><a href="../modules/types_BlockHash.html">types/<wbr/>Block<wbr/>Hash</a></li>
<li class="tsd-kind-module"><a href="../modules/types_CcdAmount.html">types/<wbr/>Ccd<wbr/>Amount</a></li>
<li class="tsd-kind-module"><a href="../modules/types_ContractAddress.html">types/<wbr/>Contract<wbr/>Address</a></li>
<li class="tsd-kind-module"><a href="../modules/types_ContractEvent.html">types/<wbr/>Contract<wbr/>Event</a></li>
<li class="tsd-kind-module"><a href="../modules/types_Duration.html">types/<wbr/>Duration</a></li>
<li class="tsd-kind-module"><a href="../modules/types_Energy.html">types/<wbr/>Energy</a></li>
<li class="tsd-kind-module"><a href="../modules/types_InitName.html">types/<wbr/>Init<wbr/>Name</a></li>
<li class="tsd-kind-module"><a href="../modules/types_ModuleReference.html">types/<wbr/>Module<wbr/>Reference</a></li>
<li class="tsd-kind-module"><a href="../modules/types_Parameter.html">types/<wbr/>Parameter</a></li>
<li class="tsd-kind-module"><a href="../modules/types_ReceiveName.html">types/<wbr/>Receive<wbr/>Name</a></li>
<li class="tsd-kind-module"><a href="../modules/types_ReturnValue.html">types/<wbr/>Return<wbr/>Value</a></li>
<li class="tsd-kind-module"><a href="../modules/types_SequenceNumber.html">types/<wbr/>Sequence<wbr/>Number</a></li>
<li class="tsd-kind-module"><a href="../modules/types_Timestamp.html">types/<wbr/>Timestamp</a></li>
<li class="tsd-kind-module"><a href="../modules/types_TransactionExpiry.html">types/<wbr/>Transaction<wbr/>Expiry</a></li>
<li class="tsd-kind-module"><a href="../modules/types_TransactionHash.html">types/<wbr/>Transaction<wbr/>Hash</a></li>
<li class="tsd-kind-module"><a href="../modules/util.html">util</a></li>
<li class="tsd-kind-module"><a href="../modules/wasm.html">wasm</a>
<ul>
<li class="tsd-kind-namespace tsd-parent-kind-module"><a href="../modules/wasm.VerifiableCredentialV1.html">Verifiable<wbr/>Credential<wbr/>V1</a></li>
<li class="tsd-kind-namespace tsd-parent-kind-module"><a href="../modules/wasm.VerifiablePresentationV1.html">Verifiable<wbr/>Presentation<wbr/>V1</a></li>
<li class="tsd-kind-namespace tsd-parent-kind-module"><a href="../modules/wasm.VerificationAuditRecordV1.html">Verification<wbr/>Audit<wbr/>Record<wbr/>V1</a></li>
<li class="tsd-kind-namespace tsd-parent-kind-module"><a href="../modules/wasm.VerificationRequestV1.html">Verification<wbr/>Request<wbr/>V1</a></li></ul></li>
<li class="tsd-kind-module"><a href="../modules/web3_id.html">web3-<wbr/>id</a></li></ul></li></ul></div></details></nav>
<nav class="tsd-navigation secondary menu-sticky"></nav></div></div>
<div class="container tsd-generator">
<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div>
<div class="overlay"></div><script src="../assets/main.js"></script></body></html>